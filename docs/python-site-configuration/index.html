<!DOCTYPE html> <html lang="en-US"> <head prefix="og: http://ogp.me/ns#"> <meta charset="UTF-8" /> <meta http-equiv="X-UA-Compatible" content="ie=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <meta name="mobile-web-app-capable" content="yes" /> <meta name="apple-mobile-web-app-capable" content="yes" /> <meta name="application-name" content="Anuradha Chowdhary" /> <meta name="apple-mobile-web-app-status-bar-style" content="#fff" /> <meta name="apple-mobile-web-app-title" content="Anuradha Chowdhary" /> <title> Python 3 Site Configuration - Anuradha Chowdhary </title> <link rel="alternate" href="https://www.achowdhary.com/python-site-configuration/" hreflang="en-US" /> <link rel="canonical" href="https://www.achowdhary.com/python-site-configuration/" /> <meta name="description" content="Configuring Airflow Webserver UI to authenticate with Active Directory/LDAP." /> <meta name="referrer" content="no-referrer-when-downgrade" /> <meta property="fb:app_id" content="" /> <meta property="og:site_name" content="Python 3 Site Configuration | Anuradha Chowdhary" /> <meta property="og:title" content="Python 3 Site Configuration | Anuradha Chowdhary" /> <meta property="og:type" content="website" /> <meta property="og:url" content="https://www.achowdhary.com/python-site-configuration/" /> <meta property="og:description" content="Configuring Airflow Webserver UI to authenticate with Active Directory/LDAP." /> <meta property="og:image" content="https://www.achowdhary.com/python-site-configuration/site-config.jpg" /> <meta property="og:image:width" content="640" /> <meta property="og:image:height" content="640" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:title" content="Python 3 Site Configuration | anu2602" /> <meta name="twitter:url" content="https://www.achowdhary.com/python-site-configuration/" /> <meta name="twitter:site" content="@anu2602" /> <meta name="twitter:creator" content="@anu2602" /> <meta name="twitter:description" content="Configuring Airflow Webserver UI to authenticate with Active Directory/LDAP." /> <meta name="twitter:image" content="https://www.achowdhary.com/python-site-configuration/site-config.jpg" /> <link type="application/atom+xml" rel="alternate" href="https://www.achowdhary.com/feed.xml" title="Anuradha Chowdhary" /> <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png" /> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png" /> <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png" /> <link rel="manifest" href="/assets/favicons/site.webmanifest" /> <link rel="mask-icon" href="/assets/favicons/safari-pinned-tab.svg" color="#5bbad5" /> <meta name="apple-mobile-web-app-title" content="Jekyll Klise" /> <meta name="application-name" content="Jekyll Klise" /> <meta name="msapplication-TileColor" content="#da532c" /> <meta name="theme-color" content="#2c2c2c" /> <link rel="stylesheet" href="/assets/css/style.css" /> </head> <body data-theme="dark" class="notransition"> <script> const body = document.body; const data = body.getAttribute("data-theme"); const initTheme = (state) => { if (state === "dark") { body.setAttribute("data-theme", "dark"); } else if (state === "light") { body.removeAttribute("data-theme"); } else { localStorage.setItem("theme", data); } }; initTheme(localStorage.getItem("theme")); setTimeout(() => body.classList.remove("notransition"), 75); </script> <div class="navbar" role="navigation"> <nav class="menu"> <input type="checkbox" id="menu-trigger" class="menu-trigger" /> <label for="menu-trigger"> <span class="menu-icon"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z" /> </svg> </span> </label> <a id="mode"> <svg class="mode-sunny" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>LIGHT</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> <svg class="mode-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>DARK</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> </a> <div class="trigger"> <div class="trigger-container"><a class="menu-link" href="/">home</a><a class="menu-link" href="/posts/">posts</a><a class="menu-link" href="/about/">about</a><a class="menu-link rss" href="/feed.xml"> <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 512 512" fill="#ED812E" > <title>RSS</title> <path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z" /> <path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z" /> <path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z" /> </svg> </a> </div> </div> </nav> </div> <div class="wrapper post"> <main class="page-content" aria-label="Content"> <article itemscope itemtype="https://schema.org/BlogPosting"> <header class="header"> <div class="tags"> <span itemprop="keywords"> <a class="tag" href="/tags/#python">PYTHON</a>, <a class="tag" href="/tags/#simplified">SIMPLIFIED</a> </span> </div> <h1 class="header-title" itemprop="headline">Python 3 Site Configuration</h1> <div class="post-meta"> <time datetime="2022-05-09T10:59:07+05:30" itemprop="datePublished"> May 09, 2022 </time> <span itemprop="author" itemscope itemtype="https://schema.org/Person"> <span itemprop="name">Anuradha Chowdhary</span> </span> <time hidden datetime="" itemprop="dateModified"> May 09, 2022 </time> <span hidden itemprop="publisher" itemtype="Person">Anuradha Chowdhary</span> <span hidden itemprop="image">/python-site-configuration/site-config.jpg</span> <span hidden itemprop="mainEntityOfPage"><figure> <img src="site-config.jpg" alt="Site Configuration" /> </figure> </span> </div> </header> <div class="page-content" itemprop="articleBody"> <figure> <img src="site-config.jpg" alt="Site Configuration" /> </figure> <p>This blog exists because the <a href="https://docs.python.org/3/library/site.html" target="_blank">official python site configuration documentation</a> is not very clear.</p> <h1 id="site-packages"> <a href="#site-packages" class="anchor-head"></a> site-packages </h1> <p>Python installation has a site-packages directory inside the module directory. This directory is where user installed packages are dropped. In other words when a new package is installed, the content of package are dropped into site-packages directory. It is the target directory of manually built Python packages. When you build and install Python packages from source (using distutils, probably by executing python setup.py install), you will find the installed modules in site-packages by default.</p> <p>The <code class="language-plaintext highlighter-rouge">site</code> module handles site-specific configuration, especially the import path or module search path. <code class="language-plaintext highlighter-rouge">site</code> is automatically imported each time the interpreter starts up. On import, it extends <code class="language-plaintext highlighter-rouge">sys.path</code> with site-specific names constructed by combining the prefix values <code class="language-plaintext highlighter-rouge">sys.prefix</code> and <code class="language-plaintext highlighter-rouge">sys.exec_prefix</code> with several suffixes. The prefix values used are saved in the module-level variable PREFIXES for reference later. Under Windows, the suffixes are an empty string and <code class="language-plaintext highlighter-rouge">lib/site-packages</code>. For Unix-like platforms, the values are <code class="language-plaintext highlighter-rouge">lib/python$version/site-packages</code> (where $version is replaced by the major and minor version number of the interpreter, such as 3.5) and <code class="language-plaintext highlighter-rouge">lib/site-python</code>.</p> <h1 id="import-path"> <a href="#import-path" class="anchor-head"></a> Import Path </h1> <p>The search path for modules is managed as a Python list saved in sys.path. The default contents of the path include the directory of the script used to start the application and the current working directory.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import sys
for pdir in sys.path:
    print pdir
</code></pre></div></div> <h1 id="pythonpath"> <a href="#pythonpath" class="anchor-head"></a> PYTHONPATH </h1> <p>This is the most non-intrusive way of modifying the default search path. The format for setting the environment variable is same as the shell’s PATH: one or more directory pathnames separated by os.pathsep (e.g. colons on Unix or semicolons on Windows). Non-existent directories are silently ignored. In addition to normal directories, individual PYTHONPATH entries may refer to zipfiles containing pure Python modules (in either source or compiled form). Extension modules cannot be imported from zipfiles.</p> <ul> <li>on Unix like system : <code class="language-plaintext highlighter-rouge">echo $PYTHONPATH</code></li> <li>on Windows : <code class="language-plaintext highlighter-rouge">echo %PYTHONPATH%</code></li> <li>from within Python <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import os
os.environ['PYTHONPATH']
</code></pre></div> </div> </li> </ul> <h1 id="user_site-and-pythonnousersite"> <a href="#user_site-and-pythonnousersite" class="anchor-head"></a> USER_SITE and PYTHONNOUSERSITE </h1> <h2 id="siteuser_site"> <a href="#siteuser_site" class="anchor-head"></a> site.USER_SITE </h2> <p>Path to the user site-packages for the running Python, defaults are:</p> <ul> <li><code class="language-plaintext highlighter-rouge">~/.local/lib/pythonX.Y/site-packages</code> for UNIX and non-framework macOS builds</li> <li><code class="language-plaintext highlighter-rouge">~/Library/Python/X.Y/lib/python/site-packages</code> for macOS framework builds</li> <li><code class="language-plaintext highlighter-rouge"> %APPDATA%\Python\PythonXY\site-packages</code> on Windows. This directory is a site directory, which means that .pth files in it will be processed (discussed below).</li> </ul> <h2 id="pythonnousersite"> <a href="#pythonnousersite" class="anchor-head"></a> PYTHONNOUSERSITE </h2> <p>The user site directory can be set through the PYTHONNOUSERSITE environment variable to override above platform-specific defaults. site.USER_BASE and PYTHONUSERBASE are related variable to configure python base directory e.g <code class="language-plaintext highlighter-rouge">~/.local</code> on Unix.</p> <h1 id="siteaddsitedir-and-syspathappend"> <a href="#siteaddsitedir-and-syspathappend" class="anchor-head"></a> site.addsitedir and sys.path.append </h1> <p>In the code following two mehtod could be used to modify the <code class="language-plaintext highlighter-rouge">sys.path</code>, or python import search path.</p> <ol> <li>sys.path.append(‘/path/to/search’)</li> <li>site.addsitedir(‘/path/to/site’)</li> </ol> <p>The difference between 1 and 2 is just plain appending is that when you use site.addsitedir, it also looks for .pth files within that directory. This directory can possibly be used to add additional directories to sys.path using .pth files (see below for more details).</p> <h1 id="pth-files"> <a href="#pth-files" class="anchor-head"></a> .pth files </h1> <p>A path configuration file is a plain text file with the extension .pth. The paths in this file can be used to extend the import path to look for location that would not have been added automatically. It’s contents are added to <code class="language-plaintext highlighter-rouge">sys.path</code>. Important points to note about .pth file.</p> <ul> <li>File must have extension of .pth e.g my-modules.pth</li> <li>File must be placed in site dir.</li> <li>Each line must contain a single path that will be appended to sys.path</li> <li>Non existant paths are ignored</li> <li>No check is made that the item refers to a directory rather than a file.</li> <li>Duplicates are ignored</li> <li>Blank lines and lines beginning with # are skipped</li> <li>Modules in the added directories will not override standard modules</li> <li>Paths can be absolute or relative</li> <li>Relative Paths are relative to the directory containing the .pth file</li> <li>Lines starting with import (followed by space or tab) are executed.</li> <li>An executable line in a .pth file is run at every Python startup.</li> <li>If a site directory contains multiple .pth files, they are processed in alphabetical order.</li> </ul> <p>Example:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>site-packages
├── mypath.pth
└── my-site
    └── mymodule.py

</code></pre></div></div> <p>mypath.pth file contains:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>my-site
</code></pre></div></div> <h1 id="sitecustomizepy-and-usercustomizepy"> <a href="#sitecustomizepy-and-usercustomizepy" class="anchor-head"></a> sitecustomize.py and usercustomize.py </h1> <p>PTH files are only processed if they are in the site-packages directory ( to be precise in a “site directory”). Site directory itself is a global setting for the Python installation and does not depend on the current/working directory. The site module is also responsible for loading site-wide customization defined by the local site owner in a sitecustomize module. Uses for sitecustomize include extending the import path and enabling coverage, profiling, or other development tools.</p> <p>After these path manipulations, an attempt is made to import a module named sitecustomize, which can perform arbitrary site-specific customizations. sitecustomize.py is imported before Python starts running your own code. This can be used to add a new site dir:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import site
site.addsitedir('/path/to/site')
</code></pre></div></div> <p>Similar to sitecustomize, the usercustomize module can be used to set up user-specific settings each time the interpreter starts up. usercustomize is loaded after sitecustomize, so site-wide customizations can be overridden.</p> <h2 id="references"> <a href="#references" class="anchor-head"></a> References </h2> <ul> <li><a href="https://docs.python.org/3/library/site.html" target="_blank">https://docs.python.org/3/library/site.html</a></li> <li><a href="https://pymotw.com/3/site/index.html" target="_blank">site — Site-wide Configuration</a></li> <li><a href="https://docs.python.org/3/using/cmdline.html" target="_blank">Python Command line and environment</a></li> </ul> </div> </article> </main> <nav class="post-nav"> <a class="post-nav-item post-nav-prev" href="/monkey-patching/" > <div class="nav-arrow">Previous</div> <span class="post-title">Python Monkey Patching</span> </a> <a class="post-nav-item post-nav-next" href="/practical-lean-architecture/"> <div class="nav-arrow">Next</div> <span class="post-title">Practical Lean Architecture</span> </a> </nav> <nav class="post-nav"></nav> <div id="disqus_thread"></div> <script> (function() { var d = document, s = d.createElement('script'); s.src = 'https://achowdhary.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <footer class="footer"> <a class="footer_item" href="/thanks">ack.</a> <a class="footer_item" href="javascript::void(0)">resume</a> <a class="footer_item" href="/feed.xml">rss</a> <!--span class="footer_item">&copy; 2022</span--> <small class="footer_copyright"> &copy 2022 Anuradha Chowdhary </small> </footer> <script src="/assets/js/main.js" defer="defer"></script> </div> </body> </html>
